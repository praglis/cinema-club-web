<div *ngIf="error" class="alert alert-danger">{{error}}</div>
<div *ngIf="success_msg != undefined" class="alert alert-success">{{success_msg}}</div>
<div class="movie-details" *ngIf="movie != undefined">
  <div class="container">

    <p class="title">{{movie.title}} ({{movie.vote_average}} / 10.0)</p>


    <div class="row">

      <div class="col align-middle">
        <div class="row" style="padding-left: 30px">
          <div class="star-rating">
            <!-- The '|| 0' would prevent an undefined or null value on the Rating property -->
            <div class="full-star" [ngStyle]="{'width': movie.vote_average * 10 + '%'}"></div>
            <div class="empty-star"> </div>
          </div>
        </div>
        <div class="row" style="padding-top: 30px">
          <img class="movie-poster" src="https://image.tmdb.org/t/p/w300/{{movie.poster_path}}">
        </div>
      </div>
      <div class="col-7">

        <p>Overview</p>
        <p id=movie-container class="overview">{{movie.overview}}</p>

        <p>Critics' reviews</p>
        <div id=movie-container class="container reviews">
          <div class="row" *ngIf="reviewNYT != null">
            <div class="col-6">
              <div class="review-title">
                {{ reviewNYT.headline }}
              </div>
              <div class="review-short">
                „{{ reviewNYT.summary_short }}”
              </div>
              <div class="review-author">
                — {{ reviewNYT.byline}}
              </div>
              <div class="review-link">
                Read more at: <a href="{{reviewNYT.link.url}}">New York Times</a>
              </div>
            </div>
            <div class="col-6" *ngIf="reviewGuardian != null">
              <div class="review-title">
                {{ reviewGuardian.webTitle }}
              </div>
              <div class="review-short">
                „{{ reviewGuardian.fields.trailText }}”
              </div>
              <div class="review-author">
                — {{ reviewGuardian.fields.byline }}
              </div>
              <div class="review-link">
                Read more at: <a href="{{reviewGuardian.webUrl}}">The Guardian</a>
              </div>
            </div>
          </div>

      </div>
    </div>

  </div>

  <div class="row" style="padding-top: 30px; padding-bottom: 30px">

    <div  class="col-5">
      <p>Details</p>

      <div id="movie-container">
        <div class="row" *ngIf="movie.original_title != null">
          <div class="col property-header">
            <p style="font-weight: bold">Original title</p>
          </div>
          <div class="col property-value">
            <p>{{movie.original_title}}</p>
          </div>
        </div>
        <div class="row" *ngIf="movie.status != null">
          <div class="col property-header">
            <p style="font-weight: bold">Status</p>
          </div>
          <div class="col property-value">
            <p>{{movie.status}}</p>
          </div>
        </div>
        <div class="row" *ngIf="movie.release_date != null">
          <div class="col property-header">
            <p style="font-weight: bold">Release date</p>
          </div>
          <div class="col property-value">
            <p>{{movie.release_date}}</p>
          </div>
        </div>
        <div class="row" *ngIf="movie.genres != null">
          <div class="col property-header">
            <p style="font-weight: bold">Genres</p>
          </div>
          <div class="col property-value">
            <p>
              <ng-container *ngFor="let genre of movie.genres">
                {{genre.name}}
              </ng-container>
            </p>
          </div>
        </div>
        <div class="row" *ngIf="movie.production_companies != null">
          <div class="col property-header">
            <p style="font-weight: bold">Production companies</p>
          </div>
          <div class="col property-value">
            <p>
              <ng-container *ngFor="let company of movie.production_companies">
                {{company.name}}
              </ng-container>
            </p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-7">
      <p>Cast</p>
      <div id="movie-container"></div>
      <!--      tutaj dać cast-->
<!--

!!!

          !!!!
                !!!!
-->
    </div>

  </div>

    <p class="title">Users' rating and comments</p>

    <div class="row" style="padding-left: 110px">
      <div class="star-rating">
      <!-- The '|| 0' would prevent an undefined or null value on the Rating property -->
        <div class="full-star2" [ngStyle]="{'width': movie.vote_average * 10 + '%'}"></div>
      <div class="empty-star"></div>
    </div>

    <div style="padding: 5px">
      <button class="btn btn-dark" type="button" (click)="onAddRateClick()">Rate movie</button>
    </div>

      <div style="padding: 5px">
      <button class="btn btn-dark" type="button" (click)="onAddReviewClick()">Comment movie</button>
    </div>

      <div style="padding: 5px">
        <button *ngIf="isMovieInFavourites" class="btn btn-dark" type="button" (click)="onRemoveMovieFromFavourites()">Delete movie from favourites</button>
        <button *ngIf="!isMovieInFavourites" class="btn btn-dark" type="button" (click)="onAddToFavourites()">Add movie to favourites</button>
      </div>

  </div>

  <div class="row" style="padding-left: 80px; padding-right: 80px">

    <div class="userReviews" class="user-review-content">

      <div *ngIf="showCommentForm" style="margin-bottom: 30px;">
        <div style="text-align: left; margin-bottom: -10px;"><p>My comment</p></div>
        <textarea #commentForm class="form-control darkTextArea" rows="3"></textarea>
        <div class="row">
          <div class="col-sm">
            <a (click)="submitComment()" class="review-button add-comment-button row float-left">Add comment</a>
          </div>
          <div class="col-sm">
            <a (click)="showCommentForm = false" class="review-button row float-right">Close button</a>
          </div>
        </div>
      </div>

      <div>
      <div id=rate-container *ngIf="showRateForm" style="margin-bottom: 30px;">

        <div style="text-align: left; margin-bottom: -10px;"><p>My rate</p></div>

        <span (click)="submitRate(1)" class="rate-button"> 1 </span>
        <span (click)="submitRate(2)" class="rate-button"> 2 </span>
        <span (click)="submitRate(3)" class="rate-button"> 3 </span>
        <span (click)="submitRate(4)" class="rate-button"> 4 </span>
        <span (click)="submitRate(5)" class="rate-button"> 5 </span>
        <span (click)="submitRate(6)" class="rate-button"> 6 </span>
        <span (click)="submitRate(7)" class="rate-button"> 7 </span>
        <span (click)="submitRate(8)" class="rate-button"> 8 </span>
        <span (click)="submitRate(9)" class="rate-button"> 9 </span>
        <span (click)="submitRate(10)" class="rate-button"> 10 </span>

          <div class="row">
            <div class="col-sm">
              <a (click)="showRateForm = false" class="review-button row float-right">Close button</a>
            </div>
          </div>
      </div>

      <div *ngIf="comments.length  === 0">
        <h2 style="text-align: center; color: dimgray; padding: 40px; opacity: 50%">No results found. Comment first!</h2>
      </div>

      <div class="comments-section" style="padding-top: 15px">
        <div *ngFor="let item of comments" class="commentArea">
          <p style="color: #6a6666; padding-top: 10px"><strong class="text-grey">{{item.infoCU.username}}</strong> write on day {{item.infoCD | date}}</p>
          <div style="margin-left: 10px; margin-right: 10px;">
            <p>{{item.statement}}</p>
          </div>
          <p style="font-size: 24px;">{{item.likes}} <a (click)="likeComment(item.id)"><i class="far fa-thumbs-up" style="padding-bottom: 15px"></i></a></p>
        </div>
      </div>
    </div>

  </div>

  </div>

</div>


